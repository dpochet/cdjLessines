<html>
<head>
</head>
<body>

<form>
	Project nr: <input type="text" value="367261285" id="projectnr"/>
	<button type="button" onclick="getJSONFile()">Get Project data</button>
</form>
<hr>
<div id="scratchprojectinfo"></div>
<p/>

<script>

var projectData;

function showProjectInfo (pd) {
	var i;
	var l;
	var projectInfo="";
	l=projectData.extensions.length;
	if (l>0) { 
		projectInfo="Project uses "+l+" extensions:<br/>";
		for (i = 0; i < l; i++) {
		  projectInfo += "- "+projectData.extensions[i] + "<br/>";
		} 
	} else { 
		projectInfo="Project uses no extension<br/>";
	}
	projectInfo+="<br/>";
	this.document.getElementById("scratchprojectinfo").innerHTML=projectInfo;
}

function getJSONFile(projectnr) {

	var data;
	
	var projectnr=this.document.getElementById("projectnr").value;
    const url = "https://projects.scratch.mit.edu/"+projectnr;

	if (false) {
//	if (window.fetch) {
		fetch(url)
		 .then (response => response.json())
		 .then(function(data) {
			projectData=data;
			console.log(projectData);
			showProjectInfo(projectData);
		})	
	} else {
		var xhr = new XMLHttpRequest();
		xhr.overrideMimeType("application/json");
//		xhr.ontimeout = function () {
//			console.error("The request for " + url + " timed out.");
//		};
		xhr.onload = function() {
			projectData = JSON.parse(xhr.responseText);
			console.log(projectData);
			showProjectInfo(projectData);
		};
		xhr.onerror = function (e) {
			console.error(xhr.statusText);
		};
		xhr.open("GET", url, true);
		xhr.send(null);
	}

}

</script>
</body>
</html>